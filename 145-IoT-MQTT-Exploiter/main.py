import threading
import time

print("--- IoT MQTT PROTOCOL ATTACK ---")

# Simüle edilmiş MQTT Broker (Sunucu)
messages = []

def broker_simulation():
    while True:
        if messages:
            msg = messages.pop(0)
            print(f"[SmartHome] Termostat Güncellendi: {msg}")
        time.sleep(1)

def attacker():
    time.sleep(2)
    print("\n[*] IoT Ağı Dinleniyor...")
    print("[*] Şifresiz 'home/livingroom/temp' konusu bulundu.")
    print("[*] SAHTE VERİ ENJEKTE EDİLİYOR...")
    
    # Zararlı payload
    payload = "{'temp': 9999, 'alert': 'FIRE'}"
    messages.append(payload)

t1 = threading.Thread(target=broker_simulation, daemon=True)
t2 = threading.Thread(target=attacker)
t1.start(); t2.start()
t2.join()