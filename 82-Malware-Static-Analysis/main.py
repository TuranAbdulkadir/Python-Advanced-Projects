import pefile
import sys

print("--- STATIC MALWARE ANALYZER ---")
# Analiz edilecek exe (Kendi bilgisayarÄ±ndan zararsÄ±z bir exe seÃ§, Ã¶rn: notepad.exe kopyasÄ±)
target_file = input("Analiz edilecek .exe dosyasÄ±: ")

try:
    pe = pefile.PE(target_file)
    
    print(f"\nğŸ“‚ Dosya: {target_file}")
    print(f"BÃ¶lÃ¼m SayÄ±sÄ±: {pe.FILE_HEADER.NumberOfSections}")
    print(f"GiriÅŸ NoktasÄ± (Entry Point): {hex(pe.OPTIONAL_HEADER.AddressOfEntryPoint)}")
    
    print("\nğŸ“¦ KULLANILAN KÃœTÃœPHANELER (DLLs):")
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        print(f"  - {entry.dll.decode()}")
        
    print("\nâš ï¸ ÅÃœPHELÄ° API Ã‡AÄRILARI:")
    suspicious_apis = ["GetKeyState", "SetWindowsHookEx", "InternetOpen", "RegCreateKey"]
    
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        for imp in entry.imports:
            api_name = imp.name.decode() if imp.name else ""
            if any(s in api_name for s in suspicious_apis):
                print(f"  ğŸš¨ {api_name} (Tehlikeli olabilir!)")
                
except Exception as e:
    print(f"Hata: {e} (Dosya geÃ§erli bir PE/EXE deÄŸil veya bulunamadÄ±)")