import socket
import requests
import pyfiglet
from datetime import datetime

banner = pyfiglet.figlet_format("PENTEST BOT 9000")
print(banner)

target = input("Hedef IP/Site: ")
report = f"PENTEST RAPORU - {target}\n" + "="*30 + "\n"

def scan_ports(ip):
    global report
    print("\n[1] Portlar TaranÄ±yor...")
    open_ports = []
    common_ports = [21, 22, 80, 443, 3306, 8080]
    
    for port in common_ports:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(0.5)
        result = s.connect_ex((ip, port))
        if result == 0:
            print(f"  -> AÃ‡IK: {port}")
            open_ports.append(port)
        s.close()
    report += f"AÃ§Ä±k Portlar: {open_ports}\n"

def check_headers(url):
    global report
    print("\n[2] GÃ¼venlik BaÅŸlÄ±klarÄ± Kontrol Ediliyor...")
    try:
        if not url.startswith("http"): url = "http://" + url
        r = requests.get(url)
        headers = r.headers
        missing = []
        if 'X-Frame-Options' not in headers: missing.append("X-Frame-Options (Clickjacking Riski)")
        if 'Strict-Transport-Security' not in headers: missing.append("HSTS (HTTPS Zorlama Yok)")
        
        for m in missing: print(f"  -> EKSÄ°K: {m}")
        report += f"Eksik BaÅŸlÄ±klar: {missing}\n"
    except:
        print("  -> BaÄŸlantÄ± HatasÄ±")

# Ã‡alÄ±ÅŸtÄ±r
scan_ports(target)
check_headers(target)

# Raporu Kaydet
with open("Final_Report.txt", "w", encoding="utf-8") as f:
    f.write(report)
    
print("\n" + "="*30)
print("ğŸ FÄ°NAL: Tarama Bitti. Rapor 'Final_Report.txt' dosyasÄ±na kaydedildi.")